<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>ChildrenMeal</title>
    <style>
        .wrap {position: absolute;left: 0;bottom: 40px;width: 288px;height: 132px;margin-left: -144px;text-align: left;overflow: hidden;font-size: 12px;font-family: 'Malgun Gothic', dotum, '돋움', sans-serif;line-height: 1.5;}
        .wrap * {padding: 0;margin: 0;}
        .wrap .info {width: 286px;height: 120px;border-radius: 5px;border-bottom: 2px solid #ccc;border-right: 1px solid #ccc;overflow: hidden;background: #fff;}
        .wrap .info:nth-child(1) {border: 0;box-shadow: 0px 1px 2px #888;}
        .info .title {padding: 5px 0 0 10px;height: 30px;background: #eee;border-bottom: 1px solid #ddd;font-size: 18px;font-weight: bold;}
        .info .close {position: absolute;top: 10px;right: 10px;color: #888;width: 17px;height: 17px;background: url('http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/overlay_close.png');}
        .info .close:hover {cursor: pointer;}
        .info .body {position: relative;overflow: hidden;}
        .info .desc {position: relative;margin: 13px 0 0 90px;height: 75px;}
        .desc .ellipsis {overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}
        .desc .jibun {font-size: 11px;color: #888;margin-top: -2px;}
        .info .img {position: absolute;top: 6px;left: 5px;width: 73px;height: 71px;border: 1px solid #ddd;color: #888;overflow: hidden;}
        .info:after {content: '';position: absolute;margin-left: -12px;left: 50%;bottom: 0;width: 22px;height: 12px;background: url('http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/vertex_white.png')}
        .info .link {color: #5085BB;}
    </style>
</head>
<body>
<div class="userInfo">
    <span th:text="${childDetailInfo.name}">이름</span>
    <span th:text="${childDetailInfo.age}">나이</span>
</div>
<div id="map" style="width:500px;height: 400px;"></div>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=657888584362b34de9ae34668675e958"></script>
<script th:inline="javascript">

    /*<![CDATA[*/
    var lat = [[ ${childDetailInfo.regionLat} ]];
    var lng = [[ ${childDetailInfo.regionLng} ]];
    /*]]>*/
    var mapContainer = document.getElementById('map');
    var mapOptions = {
        center : new kakao.maps.LatLng(lat,lng),//중앙 ( 본인 )
        level : 5
    };

    var imageSrc = "http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png",//현재위치 이미 (별)
        imageSize = new kakao.maps.Size(24,35),
        imageOption = {offset : new kakao.maps.Point(27,35)};


    var markerImage = new kakao.maps.MarkerImage(imageSrc,imageSize,imageOption);
    var map = new kakao.maps.Map(mapContainer,mapOptions);

    var markerPosition =  new kakao.maps.LatLng(lat,lng);

    var marker = new kakao.maps.Marker({
        position:markerPosition,
        image:markerImage
    });

    marker.setMap(map);

    /*<![CDATA[*/
    var list = [[${restaurantData}]];
    /*]]>*/

    var positions = [
        {
            /*<![CDATA[*/
            content :
                '<div class="wrap">' +
                '    <div class="info">' +
                '        <div class="title">' +
                            list[0].resName +
                '        </div>' +
                '        <div class="body">' +
                '            <div class="img">' +
                '                <img src="http://cfile181.uf.daum.net/image/250649365602043421936D" width="73" height="70"/>' +
                '           </div>' +
                '            <div class="desc">' +
                '                <div class="ellipsis">제주특별자치도 제주시 첨단로 242</div>' +
                '                <div class="jibun ellipsis">(우) 63309 (지번) 영평동 2181</div>' +
                '                <div><a href="http://www.kakaocorp.com/main" target="_blank" class="link">홈페이지</a></div>' +
                '            </div>' +
                '        </div>' +
                '    </div>' +
                '</div>',
            /*]]>*/
            latlng : new kakao.maps.LatLng(list[0].regionLat,list[0].regionLng)
        },
        {
            content : list[1].resName,
            latlng : new kakao.maps.LatLng(list[1].regionLat,list[1].regionLng)
        },
        {
            content : list[2].resName,
            latlng : new kakao.maps.LatLng(list[2].regionLat,list[2].regionLng)
        },
        {
            content : list[3].resName,
            latlng : new kakao.maps.LatLng(list[3].regionLat,list[3].regionLng)
        }
    ];

    /*<![CDATA[*/
    for(var j=0;j<positions.length;j++){
        var resMarKer = new kakao.maps.Marker({
            map:map,
            position:positions[j].latlng,
            clickable:true
        });
        resMarKer.setMap(map);
        //마커클릭
        var infowindow = new kakao.maps.InfoWindow({
            content : positions[j].content,
            removable : true,
            position : positions[j].latlng
        });
        kakao.maps.event.addListener(resMarKer, 'click', makeClickListener(map,resMarKer,infowindow));
        function makeClickListener(map,resMarKer,infowindow) {
            return function(){
                infowindow.open(map,resMarKer);
            };
        }
    }
    /*]]>*/

    //지도 움직임
    var mapTypeControl = new kakao.maps.MapTypeControl();
    map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
    var zoomControl = new kakao.maps.ZoomControl();
    map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

</script>
</body>
</html>